<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Resume Editor Web Component Example</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        display: flex;
        flex-direction: column;
        height: 100vh;
        background-color: #f5f5f5;
      }

      .header {
        padding: 20px;
        background-color: #ffffff;
        border-bottom: 1px solid #e0e0e0;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      .header h1 {
        margin-bottom: 10px;
        color: #333;
      }

      .controls {
        display: flex;
        gap: 15px;
        flex-wrap: wrap;
        align-items: center;
      }

      .control-group {
        display: flex;
        gap: 8px;
        align-items: center;
      }

      label {
        font-weight: 500;
        color: #555;
        white-space: nowrap;
      }

      select,
      button {
        padding: 8px 12px;
        border: 1px solid #ddd;
        border-radius: 4px;
        background-color: #ffffff;
        cursor: pointer;
        font-size: 14px;
        transition: background-color 0.2s;
      }

      select:hover,
      button:hover {
        background-color: #f0f0f0;
      }

      button {
        background-color: #007bff;
        color: white;
        border-color: #0056b3;
        font-weight: 500;
      }

      button:hover {
        background-color: #0056b3;
      }

      .button-group {
        display: flex;
        gap: 8px;
      }

      .editor-container {
        flex: 1;
        display: flex;
        overflow: hidden;
      }

      resume-editor {
        flex: 1;
        overflow: auto;
      }

      .info-panel {
        width: 300px;
        border-left: 1px solid #e0e0e0;
        background-color: white;
        padding: 15px;
        overflow-y: auto;
        box-shadow: -2px 0 4px rgba(0, 0, 0, 0.05);
      }

      .info-panel h3 {
        margin-bottom: 10px;
        color: #333;
        font-size: 14px;
        font-weight: 600;
        text-transform: uppercase;
      }

      .info-panel pre {
        background-color: #f5f5f5;
        padding: 10px;
        border-radius: 4px;
        font-size: 12px;
        overflow-x: auto;
        color: #333;
        border: 1px solid #e0e0e0;
      }

      .json-display {
        max-height: 500px;
        overflow-y: auto;
        font-family: "Monaco", "Courier New", monospace;
      }

      .validation-error {
        color: #d32f2f;
        font-size: 12px;
        margin-top: 5px;
      }

      .success {
        color: #388e3c;
      }
    </style>
  </head>
  <body>
    <div class="header">
      <h1>ðŸ“„ Resume Editor Web Component Demo</h1>
      <div class="controls">
        <div class="control-group">
          <label for="locale-select">Language:</label>
          <select id="locale-select">
            <option value="en-US">English (US)</option>
            <option value="es-ES">Spanish</option>
            <option value="fr-FR">French</option>
            <option value="de-DE">German</option>
            <option value="ja-JP">Japanese</option>
            <option value="zh-CN">Chinese (Simplified)</option>
          </select>
        </div>

        <div class="control-group">
          <label for="theme-select">Theme:</label>
          <select id="theme-select">
            <option value="light">Light</option>
            <option value="dark">Dark</option>
          </select>
        </div>

        <div class="control-group">
          <label for="page-numbers-toggle">
            <input type="checkbox" id="page-numbers-toggle" checked />
            Show Page Numbers
          </label>
        </div>

        <div class="button-group">
          <button id="reset-btn">Reset to Default</button>
          <button id="export-btn">Export JSON</button>
          <button id="clear-panel-btn">Clear Panel</button>
        </div>
      </div>
    </div>

    <div class="editor-container">
      <resume-editor id="editor"></resume-editor>
      <div class="info-panel">
        <h3>Resume Data</h3>
        <div id="resume-data" class="json-display"></div>
        <div id="validation-message"></div>
      </div>
    </div>

    <script type="module">
      // Import the web component
      import "./resume-editor.js";

      const editor = document.getElementById("editor");
      const localeSelect = document.getElementById("locale-select");
      const themeSelect = document.getElementById("theme-select");
      const pageNumbersToggle = document.getElementById("page-numbers-toggle");
      const resetBtn = document.getElementById("reset-btn");
      const exportBtn = document.getElementById("export-btn");
      const clearPanelBtn = document.getElementById("clear-panel-btn");
      const resumeDataDiv = document.getElementById("resume-data");
      const validationMessage = document.getElementById("validation-message");

      // Default resume data (clone from the component's current schema)
      const defaultResumeData = JSON.parse(JSON.stringify(editor.value));

      // Add a bit of demo data
      defaultResumeData.basics.name = "John Doe";
      defaultResumeData.basics.headline = "Full-stack developer";
      defaultResumeData.basics.email = "john@example.com";
      defaultResumeData.basics.phone = "+1 (555) 123-4567";
      defaultResumeData.basics.location = "San Francisco, CA";
      defaultResumeData.basics.website = { url: "https://johndoe.com", label: "johndoe.com" };
      defaultResumeData.summary.title = "Summary";
      defaultResumeData.summary.content = "<p>Full-stack developer passionate about building scalable web applications.</p>";

      defaultResumeData.sections.experience.items = [
        {
          id: "exp-1",
          hidden: false,
          company: "Tech Company Inc.",
          position: "Senior Developer",
          location: "San Francisco, CA",
          period: "Jan 2020 - Present",
          website: { url: "", label: "" },
          description: "<p>Led development of key features and mentored junior developers.</p>",
        },
      ];

      defaultResumeData.sections.education.items = [
        {
          id: "edu-1",
          hidden: false,
          school: "University of Technology",
          degree: "BSc Computer Science",
          area: "Computer Science",
          grade: "Honors",
          location: "Boston, MA",
          period: "2016 - 2020",
          website: { url: "", label: "" },
          description: "<p>Graduated with honors.</p>",
        },
      ];

      defaultResumeData.sections.skills.items = [
        {
          id: "skill-1",
          hidden: false,
          icon: "",
          name: "JavaScript / TypeScript",
          proficiency: "Expert",
          level: 5,
          keywords: [],
        },
        {
          id: "skill-2",
          hidden: false,
          icon: "",
          name: "React",
          proficiency: "Advanced",
          level: 4,
          keywords: [],
        },
        {
          id: "skill-3",
          hidden: false,
          icon: "",
          name: "Node.js",
          proficiency: "Advanced",
          level: 4,
          keywords: [],
        },
      ];

      // Initialize editor with default data
      editor.value = defaultResumeData;

      // Update resume data display
      const updateResumDataDisplay = (data) => {
        try {
          resumeDataDiv.textContent = JSON.stringify(data, null, 2);
          validationMessage.innerHTML = '<span class="success">âœ“ Valid resume data</span>';
        } catch (error) {
          validationMessage.innerHTML = `<div class="validation-error">Error: ${error.message}</div>`;
        }
      };

      // Locale change
      localeSelect.addEventListener("change", (e) => {
        editor.setAttribute("locale", e.target.value);
      });

      // Theme change
      themeSelect.addEventListener("change", (e) => {
        editor.setAttribute("theme", e.target.value);
      });

      // Page numbers toggle
      pageNumbersToggle.addEventListener("change", (e) => {
        editor.setAttribute("show-page-numbers", e.target.checked.toString());
      });

      // Reset button
      resetBtn.addEventListener("click", () => {
        editor.value = defaultResumeData;
        updateResumDataDisplay(defaultResumeData);
      });

      // Export button
      exportBtn.addEventListener("click", () => {
        const data = editor.value;
        const blob = new Blob([JSON.stringify(data, null, 2)], { type: "application/json" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = `resume-${new Date().toISOString().split("T")[0]}.json`;
        a.click();
        URL.revokeObjectURL(url);
      });

      // Clear panel button
      clearPanelBtn.addEventListener("click", () => {
        resumeDataDiv.textContent = "";
        validationMessage.innerHTML = "";
      });

      // Listen to resume changes
      editor.addEventListener("resume-change", (e) => {
        updateResumDataDisplay(e.detail);
      });

      // Initial display
      updateResumDataDisplay(defaultResumeData);

      console.log("Resume Editor Web Component loaded successfully!");
      console.log("Editor element:", editor);
    </script>
  </body>
</html>
